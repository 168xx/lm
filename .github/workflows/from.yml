name: Remove URLs and Save as tt.txt  
  
on:  
  push:  
    paths:  
      - 'tv.txt'  # 只在这个文件发生变化时触发  
  workflow_dispatch:  # 允许手动触发  
  
jobs:  
  remove-urls-and-save:  
    runs-on: ubuntu-latest  
  
    steps:  
    - name: Checkout repository  
      uses: actions/checkout@v2  
  
    - name: Remove URLs and save as tt.txt  
      run: |  
        # 使用 sed 命令处理 tv.txt，并将结果保存到临时文件 temp.txt  
        sed 's|http[s?]://[^ ]*||g' tv.txt > temp.txt  
          
        # 检查 temp.txt 是否与 tv.txt 不同（避免在没有更改时覆盖原始文件）  
        if cmp -s tv.txt temp.txt; then  
          echo "No changes to save."  
          # 如果没有更改，可以选择删除临时文件（可选）  
          rm temp.txt  
        else  
          # 如果有更改，将临时文件重命名为 tt.txt  
          mv temp.txt tt.txt  
        fi  
  
    - name: Commit changes  
      run: |
        git config --local user.email "github-actions[bot]@users.noreply.github.com"
        git config --local user.name "github-actions[bot]"
        git add -A
        if ! git diff --staged --quiet; then
          git commit -m "Auto-update live files"
          git push
        fi

    env: